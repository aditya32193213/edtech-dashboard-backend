openapi: 3.0.0
info:
  title: EdTech Dashboard Backend API
  description: REST API documentation for EdTech Dashboard (Auth, Courses, Enrollments, Payments, Progress)
  version: 1.0.0

servers:
  - url: http://localhost:10000
    description: Local server
  - url: https://your-backend.onrender.com
    description: Production server

tags:
  - name: Auth
  - name: Courses
  - name: Enrollments
  - name: Payments
  - name: Progress

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

security:
  - bearerAuth: []

paths:

  /api/auth/register:
    post:
      tags: [Auth]
      summary: Register a new user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, email, password, role]
              properties:
                name:
                  type: string
                email:
                  type: string
                password:
                  type: string
                role:
                  type: string
                  enum: [student, instructor]
      responses:
        201:
          description: User registered successfully

  /api/auth/login:
    post:
      tags: [Auth]
      summary: Login user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                password:
                  type: string
      responses:
        200:
          description: Login successful

  /api/courses:
    get:
      tags: [Courses]
      summary: Get all courses
      responses:
        200:
          description: List of courses

    post:
      tags: [Courses]
      summary: Create course (Instructor only)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, description, price]
              properties:
                title:
                  type: string
                description:
                  type: string
                price:
                  type: number
                category:
                  type: string
                duration:
                  type: string
                level:
                  type: string
                videoUrl:
                  type: string
      responses:
        201:
          description: Course created

  /api/courses/{courseId}:
    get:
      tags: [Courses]
      summary: Get course by ID
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Course details

  /api/enroll/{courseId}:
    post:
      tags: [Enrollments]
      summary: Enroll in a course
      security:
        - bearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
      responses:
        201:
          description: Enrolled successfully

  /api/enrollments:
    get:
      tags: [Enrollments]
      summary: Get logged-in user's enrollments
      security:
        - bearerAuth: []
      responses:
        200:
          description: Enrollment list

  /api/enrollments/after-payment:
    post:
      tags: [Enrollments]
      summary: Enroll after Stripe payment
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [courseId]
              properties:
                courseId:
                  type: string
      responses:
        201:
          description: Enrollment successful

  /api/payments/checkout:
    post:
      tags: [Payments]
      summary: Create Stripe checkout session
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [courseId, title, price]
              properties:
                courseId:
                  type: string
                title:
                  type: string
                price:
                  type: number
      responses:
        200:
          description: Stripe session created

  /api/progress/{courseId}:
    patch:
      tags: [Progress]
      summary: Update course progress
      security:
        - bearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [completedPercentage]
              properties:
                completedPercentage:
                  type: number
      responses:
        200:
          description: Progress updated
